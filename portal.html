<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Client Portal | Prime Book</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    .portal-container { max-width: 800px; margin: 100px auto; padding: 40px; background: white; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border-top: 5px solid #b89733; }
    .welcome-h1 { color: #1a2b48; font-family: Montserrat, sans-serif; font-size: 28px; margin-bottom: 10px; }
    .client-name { color: #b89733; }
    .report-card { display: flex; align-items: center; justify-content: space-between; background: #f9f9fb; padding: 20px; border-radius: 8px; margin-top: 20px; border: 1px solid #eee; }
    .btn-download { background: #1a2b48; color: white; padding: 10px 20px; border-radius: 4px; text-decoration: none; font-weight: bold; transition: 0.3s; }
    .btn-download:hover { background: #b89733; }
    #loading-screen { text-align: center; margin-top: 200px; font-family: sans-serif; color: #666; }
  </style>
</head>
<body style="background: #f4f6f8;">

  <div id="loading-screen">
    <i class="fas fa-spinner fa-spin fa-2x"></i>
    <p>Securing your connection...</p>
  </div>

  <div id="portal-content" style="display: none;">
    <div class="portal-container">
      <div style="text-align: right; margin-bottom: 20px;">
        <div id="user-button"></div>
      </div>
      
      <h1 class="welcome-h1">Welcome back, <span id="client-name" class="client-name">Client</span>!</h1>
      <p>Your 2026 Financial Overview & Compliance Documents</p>

      <hr style="border: 0; border-top: 1px solid #eee; margin: 25px 0;">

      <div class="report-card">
        <div>
          <h3 style="margin: 0; color: #1a2b48;">Monthly Management Report</h3>
          <small style="color: #888;">Updated: January 2026</small>
        </div>
        <a href="YOUR_GOOGLE_DRIVE_OR_DROPBOX_LINK" target="_blank" class="btn-download">
          <i class="fas fa-file-pdf"></i> View Folder
        </a>
      </div>

      <div style="margin-top: 40px; text-align: center;">
        <a href="index.html" style="color: #1a2b48; text-decoration: none; font-size: 14px;">‚Üê Back to Home</a>
      </div>
    </div>
  </div>

  <script
    async
    crossorigin="anonymous"
    data-clerk-publishable-key="pk_test_Y29uY2lzZS1tYWxhbXV0ZS01Ny5jbGVyay5hY2NvdW50cy5kZXYk"
    src="https://concise-malamute-57.clerk.accounts.dev/npm/@clerk/clerk-js@latest/dist/clerk.browser.js"
    type="text/javascript"
  ></script>

  <script>
    window.addEventListener('load', async function () {
      await window.Clerk.load();

      if (window.Clerk.user) {
        const userEmail = window.Clerk.user.primaryEmailAddress.emailAddress;
    const downloadBtn = document.getElementById('report-link');
    const welcomeMsg = document.getElementById('welcome-subtext');

    // --- CLIENT DATABASE START ---
    const clientLinks = {
      "client1@gmail.com": "https://drive.google.com/drive/folders/ABC_LINK_1",
      "client2@yahoo.com": "https://drive.google.com/drive/folders/XYZ_LINK_2",
      "newclient@prime.com": "https://drive.google.com/drive/folders/NEW_LINK_3"
    };
    // --- CLIENT DATABASE END ---

    if (clientLinks[userEmail]) {
        // If the email is in our list, give them their link
        downloadBtn.href = clientLinks[userEmail];
        downloadBtn.innerHTML = '<i class="fas fa-folder-open"></i> Access My Reports';
        welcomeMsg.innerText = "Your financial documents are ready for review.";
    } else {
        // If they just signed up and you haven't added them yet
        downloadBtn.href = "javascript:void(0)";
        downloadBtn.style.background = "#666"; // Grey out the button
        downloadBtn.innerText = "Setup in Progress...";
        welcomeMsg.innerText = "Welcome! We are currently setting up your secure folder. Please check back in 24 hours.";
    }

        // 1. Hide loading and show portal
        document.getElementById('loading-screen').style.display = 'none';
        document.getElementById('portal-content').style.display = 'block';

        // 2. Personalize the Greeting
        const firstName = window.Clerk.user.firstName || "Valued Client";
        document.getElementById('client-name').innerText = firstName;

        // 3. Mount User Settings Button
        window.Clerk.mountUserButton(document.getElementById('user-button'));
      } else {
        // 4. Redirect to home if not logged in
        window.location.href = "index.html";
      }
      
    });
  </script>
</body>
</html>
